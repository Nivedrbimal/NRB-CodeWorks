<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NRB Codeworks — Math & Physics Web App (Enhanced)</title>
  <style>
    :root{--bg:#071018;--panel:#0b1220;--muted:#9aa3b2;--text:#e6edf3;--accent:#60a5fa}
    *{box-sizing:border-box}body{margin:0;background:linear-gradient(180deg,#071018,#041018);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial}
    .app{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
    aside{padding:18px;border-right:1px solid rgba(255,255,255,.03);background:#07151f}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    main{padding:28px}
    .card{background:linear-gradient(180deg,#081421,#071019);border:1px solid rgba(255,255,255,.03);border-radius:12px;padding:12px;margin-bottom:14px}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    input,select{padding:8px 10px;border-radius:8px;border:1px solid #123; background:#07141e;color:var(--text)}
    .actions{margin-top:8px}
    .btn{padding:8px 12px;border-radius:9px;border:none;background:#1f6feb;color:white;cursor:pointer}
    .out{padding:10px;border-radius:8px;background:#061018;border:1px dashed rgba(255,255,255,.03);min-height:36px}
    label{font-size:.86rem;color:var(--muted)}
    .small{font-size:.85rem;color:var(--muted)}
    .muted{color:var(--muted)}
    .inline{display:inline-flex;align-items:center;gap:8px}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .kbd{background:#07151f;padding:6px 8px;border-radius:6px;border:1px solid rgba(255,255,255,.02)}
  </style>
</head>
<body>
  <div class="app">
    <aside>
      <div class="brand">NRB Codeworks <span class="small muted">— enhanced port</span></div>
      <nav style="margin-top:18px;display:flex;flex-direction:column;gap:6px">
        <button class="nav btn" data-target="home">Home</button>
        <button class="nav btn" data-target="mac">Math Calculators</button>
        <button class="nav btn" data-target="pac">Physics (PAC)</button>
        <button class="nav btn" data-target="tools">Utils & Games</button>
      </nav>
      <div style="margin-top:18px" class="small muted">Tip: enter any values you know — leave unknowns blank. The solver will attempt to compute the rest.</div>
    </aside>
    <main>
      <section id="home" class="card">
        <h2 style="margin:0">Welcome — Enhanced Conversion</h2>
        <p class="muted">I updated the web port to support: <strong>multi-input solvers</strong> (enter any known variables), and a full trig tool that supports all trig functions and inverse functions in degrees or radians. Use the Physics menu for kinematics and projectile solvers that deduce unknowns from any known subset.</p>
      </section>

      <section id="mac">
        <div class="card">
          <h3>Kinematics generic solver (s, u, v, a, t)</h3>
          <p class="muted">Enter any of the variables you know (leave blanks for unknowns). The solver repeatedly applies the 4 kinematic equations to compute missing values where possible.</p>
          <div class="grid-2">
            <div>
              <label>Displacement (s)</label>
              <input id="kin_s" type="number" step="any" placeholder="(meters)">
            </div>
            <div>
              <label>Initial velocity (u)</label>
              <input id="kin_u" type="number" step="any" placeholder="(m/s)">
            </div>
            <div>
              <label>Final velocity (v)</label>
              <input id="kin_v" type="number" step="any" placeholder="(m/s)">
            </div>
            <div>
              <label>Acceleration (a)</label>
              <input id="kin_a" type="number" step="any" placeholder="(m/s²)">
            </div>
            <div>
              <label>Time (t)</label>
              <input id="kin_t" type="number" step="any" placeholder="(s)">
            </div>
          </div>
          <div class="actions"><button class="btn" onclick="kinematics_solve()">Solve</button> <button class="btn" onclick="kinematics_clear()">Clear</button></div>
          <div id="kin_out" class="out"></div>
        </div>

        <div class="card">
          <h3>Trigonometry / Function evaluator</h3>
          <p class="muted">Compute any trig function or its inverse. Supports degrees or radians and all standard functions including sec, csc, cot and inverse functions.</p>
          <div class="row">
            <div style="min-width:200px">
              <label>Mode</label>
              <select id="tri_mode"><option value="deg">Degrees</option><option value="rad">Radians</option></select>
            </div>
            <div style="min-width:260px">
              <label>Operation</label>
              <select id="tri_op">
                <option value="sin">sin</option>
                <option value="cos">cos</option>
                <option value="tan">tan</option>
                <option value="csc">csc</option>
                <option value="sec">sec</option>
                <option value="cot">cot</option>
                <option value="asin">arcsin</option>
                <option value="acos">arccos</option>
                <option value="atan">arctan</option>
                <option value="asec">arcsec</option>
                <option value="acsc">arccsc</option>
                <option value="acot">arccot</option>
              </select>
            </div>
            <div style="min-width:220px">
              <label>Input value</label>
              <input id="tri_val" type="number" step="any" placeholder="angle (deg/rad) or value for inverse">
            </div>
          </div>
          <div class="actions"><button class="btn" onclick="trig_compute()">Compute</button></div>
          <div id="tri_out" class="out"></div>
        </div>

        <div class="card">
          <h3>Triangle solver (sides & angles)</h3>
          <p class="muted">Enter any combination of sides (a,b,c) and angles (A,B,C in degrees). The solver will attempt to compute the rest using law of sines/cosines and angle sum.</p>
          <div class="row">
            <div style="min-width:140px"><label>Side a</label><input id="tri_a" type="number" step="any"></div>
            <div style="min-width:140px"><label>Side b</label><input id="tri_b" type="number" step="any"></div>
            <div style="min-width:140px"><label>Side c</label><input id="tri_c" type="number" step="any"></div>
            <div style="min-width:140px"><label>Angle A (deg)</label><input id="tri_A" type="number" step="any"></div>
            <div style="min-width:140px"><label>Angle B (deg)</label><input id="tri_B" type="number" step="any"></div>
            <div style="min-width:140px"><label>Angle C (deg)</label><input id="tri_C" type="number" step="any"></div>
          </div>
          <div class="actions"><button class="btn" onclick="triangle_solve()">Solve Triangle</button> <button class="btn" onclick="triangle_clear()">Clear</button></div>
          <div id="tri_out" class="out"></div>
        </div>
      </section>

      <section id="pac">
        <div class="card">
          <h3>Projectile motion — flexible solver</h3>
          <p class="muted">Enter any known values among initial speed v₀, launch angle θ (deg), gravity g, time of flight T, range R, max height H. The solver will compute the rest where mathematically possible.</p>
          <div class="row">
            <div style="min-width:160px"><label>v₀ (m/s)</label><input id="pm_v0_f" type="number" step="any"></div>
            <div style="min-width:160px"><label>θ (deg)</label><input id="pm_theta_f" type="number" step="any"></div>
            <div style="min-width:160px"><label>g (m/s²)</label><input id="pm_g_f" type="number" step="any" value="9.81"></div>
            <div style="min-width:160px"><label>T (time of flight)</label><input id="pm_T_f" type="number" step="any"></div>
            <div style="min-width:160px"><label>R (range)</label><input id="pm_R_f" type="number" step="any"></div>
            <div style="min-width:160px"><label>H (max height)</label><input id="pm_H_f" type="number" step="any"></div>
          </div>
          <div class="actions"><button class="btn" onclick="proj_flexible()">Solve Projectile</button> <button class="btn" onclick="proj_clear()">Clear</button></div>
          <div id="pm_out" class="out"></div>
        </div>
      </section>

      <section id="tools">
        <div class="card">
          <h3>Games & Utilities</h3>
          <p class="muted">Previously implemented quiz and number guessing remain available in the original port (scaffold). Tell me which additional Java features to prioritize and I'll port them next.</p>
        </div>
      </section>
    </main>
  </div>

  <script>
    // NAV
    document.querySelectorAll('.nav').forEach(b=>b.addEventListener('click',()=>{
      const id=b.dataset.target; document.querySelectorAll('main section').forEach(s=>s.style.display = s.id===id? 'block':'none');
    }));
    // show default
    document.querySelector('.nav').click();

    // Helpers
    const isNum = v => v !== null && v !== '' && !Number.isNaN(Number(v));
    const toNum = v => isNum(v)? Number(v) : null;
    const fmt = n => (n===null||n===undefined||!Number.isFinite(n))? '—' : (Math.abs(n) < 1e-6 ? n.toExponential(4) : Number(n.toPrecision(12)).toString());

    // ------------ KINEMATICS SOLVER --------------
    function kinematics_clear(){ ['kin_s','kin_u','kin_v','kin_a','kin_t'].forEach(id=>document.getElementById(id).value=''); document.getElementById('kin_out').textContent=''; }
    function kinematics_solve(){
      // variables: s,u,v,a,t (can be null)
      let s=toNum(document.getElementById('kin_s').value);
      let u=toNum(document.getElementById('kin_u').value);
      let v=toNum(document.getElementById('kin_v').value);
      let a=toNum(document.getElementById('kin_a').value);
      let t=toNum(document.getElementById('kin_t').value);
      const known = (x)=> x!==null;
      // iterative solver: apply formulas until no change or limit
      let changed=true; let iter=0;
      while(changed && iter<20){ changed=false; iter++;
        // v = u + a t
        if(!known(v) && known(u) && known(a) && known(t)){ v = u + a*t; changed=true; }
        if(!known(u) && known(v) && known(a) && known(t)){ u = v - a*t; changed=true; }
        if(!known(a) && known(v) && known(u) && known(t) && t!==0){ a = (v - u)/t; changed=true; }
        if(!known(t) && known(v) && known(u) && known(a) && a!==0){ t = (v - u)/a; changed=true; }
        // s = u t + 0.5 a t^2
        if(!known(s) && known(u) && known(t) && known(a)){ s = u*t + 0.5*a*t*t; changed=true; }
        if(!known(u) && known(s) && known(t) && t!==0 && !known(a)){ u = (s - 0.5*(a||0)*t*t)/t; /* may be wrong if a unknown */ }
        // v^2 = u^2 + 2 a s
        if(!known(v) && known(u) && known(a) && known(s)){ const val = u*u + 2*a*s; if(val>=0){ v = Math.sqrt(val); changed=true; }}
        if(!known(u) && known(v) && known(a) && known(s)){ const val = v*v - 2*a*s; if(val>=0){ u = Math.sqrt(val); changed=true; }}
        if(!known(a) && known(v) && known(u) && known(s) && s!==0){ a = (v*v - u*u)/(2*s); changed=true; }
        // s = (u+v)/2 * t
        if(!known(s) && known(u) && known(v) && known(t)){ s = (u+v)/2 * t; changed=true; }
        if(!known(t) && known(s) && known(u) && known(v) && (u+v)!==0){ t = (2*s)/(u+v); changed=true; }
      }
      const out = `Iterations: ${iter}
`+
        `s = ${fmt(s)}
u = ${fmt(u)}
v = ${fmt(v)}
a = ${fmt(a)}
t = ${fmt(t)}`;
      document.getElementById('kin_out').textContent = out;
    }

    // ------------ TRIG / FUNCTION EVALUATOR --------------
    function trig_compute(){
      const mode = document.getElementById('tri_mode').value; // deg or rad
      const op = document.getElementById('tri_op').value;
      const raw = document.getElementById('tri_val').value;
      if(raw===''){ document.getElementById('tri_out').textContent='Enter a value.'; return; }
      const x = Number(raw);
      const toRad = v => mode==='deg' ? v * Math.PI/180 : v;
      const fromRad = v => mode==='deg' ? v * 180/Math.PI : v;
      try{
        let res = null; let note='';
        switch(op){
          case 'sin': res = Math.sin(toRad(x)); break;
          case 'cos': res = Math.cos(toRad(x)); break;
          case 'tan': res = Math.tan(toRad(x)); break;
          case 'csc': res = 1/Math.sin(toRad(x)); break;
          case 'sec': res = 1/Math.cos(toRad(x)); break;
          case 'cot': res = 1/Math.tan(toRad(x)); break;
          case 'asin': { let v = Math.asin(x); res = fromRad(v); note='(output in chosen mode)'; break; }
          case 'acos': { let v = Math.acos(x); res = fromRad(v); note='(output in chosen mode)'; break; }
          case 'atan': { let v = Math.atan(x); res = fromRad(v); note='(output in chosen mode)'; break; }
          case 'asec': { let v = 1/x; let r = Math.acos(1/v); res = fromRad(r); note='(arcsec computed via acos(1/x))'; break; }
          case 'acsc': { let v = 1/x; let r = Math.asin(1/v); res = fromRad(r); note='(arccsc via asin(1/x))'; break; }
          case 'acot': { let r = Math.atan(1/x); res = fromRad(r); note='(arccot via atan(1/x))'; break; }
        }
        document.getElementById('tri_out').textContent = `Result: ${fmt(res)} ${note}`;
      }catch(e){ document.getElementById('tri_out').textContent = 'Error computing function: '+e.message; }
    }

    // ------------ TRIANGLE SOLVER (law of sines/cosines) --------------
    function triangle_clear(){ ['tri_a','tri_b','tri_c','tri_A','tri_B','tri_C'].forEach(id=>document.getElementById(id).value=''); document.getElementById('tri_out').textContent=''; }
    function triangle_solve(){
      let a = toNum(document.getElementById('tri_a').value);
      let b = toNum(document.getElementById('tri_b').value);
      let c = toNum(document.getElementById('tri_c').value);
      let A = toNum(document.getElementById('tri_A').value);
      let B = toNum(document.getElementById('tri_B').value);
      let C = toNum(document.getElementById('tri_C').value);
      // convert given angles to radians for computation
      const deg2rad = d => d * Math.PI/180;
      const rad2deg = r => r * 180/Math.PI;
      // iterative approach: try to compute missing values using laws until stable
      let changed=true; let iter=0;
      while(changed && iter<20){ changed=false; iter++;
        // angle sum
        if(A!==null && B!==null && C===null){ C = 180 - A - B; changed=true; }
        if(A!==null && C!==null && B===null){ B = 180 - A - C; changed=true; }
        if(B!==null && C!==null && A===null){ A = 180 - B - C; changed=true; }
        // law of sines: a/sinA = b/sinB = c/sinC
        if(A!==null && a!==null && B!==null && b===null){ b = a * Math.sin(deg2rad(B)) / Math.sin(deg2rad(A)); changed=true; }
        if(A!==null && a!==null && C!==null && c===null){ c = a * Math.sin(deg2rad(C)) / Math.sin(deg2rad(A)); changed=true; }
        if(B!==null && b!==null && A!==null && a===null){ a = b * Math.sin(deg2rad(A)) / Math.sin(deg2rad(B)); changed=true; }
        if(B!==null && b!==null && C!==null && c===null){ c = b * Math.sin(deg2rad(C)) / Math.sin(deg2rad(B)); changed=true; }
        if(C!==null && c!==null && A!==null && a===null){ a = c * Math.sin(deg2rad(A)) / Math.sin(deg2rad(C)); changed=true; }
        if(C!==null && c!==null && B!==null && b===null){ b = c * Math.sin(deg2rad(B)) / Math.sin(deg2rad(C)); changed=true; }
        // law of cosines to compute sides from two sides and included angle
        if(A!==null && b!==null && c!==null && a===null){ // a^2 = b^2 + c^2 - 2bc cosA
          const val = b*b + c*c - 2*b*c*Math.cos(deg2rad(A)); if(val>=0){ a = Math.sqrt(val); changed=true; }
        }
        if(B!==null && a!==null && c!==null && b===null){ const val = a*a + c*c - 2*a*c*Math.cos(deg2rad(B)); if(val>=0){ b = Math.sqrt(val); changed=true; } }
        if(C!==null && a!==null && b!==null && c===null){ const val = a*a + b*b - 2*a*b*Math.cos(deg2rad(C)); if(val>=0){ c = Math.sqrt(val); changed=true; } }
        // compute angle from law of cosines if sides present
        if(a!==null && b!==null && c!==null){ if(A===null){ const v = (b*b + c*c - a*a)/(2*b*c); if(v<=1 && v>=-1){ A = rad2deg(Math.acos(v)); changed=true; }} if(B===null){ const v=(a*a + c*c - b*b)/(2*a*c); if(v<=1 && v>=-1){ B = rad2deg(Math.acos(v)); changed=true; }} if(C===null){ const v=(a*a + b*b - c*c)/(2*a*b); if(v<=1 && v>=-1){ C = rad2deg(Math.acos(v)); changed=true; } } }
      }
      const out = `Iterations: ${iter}
`+
        `a = ${fmt(a)}
b = ${fmt(b)}
c = ${fmt(c)}
A = ${fmt(A)}°
B = ${fmt(B)}°
C = ${fmt(C)}°`;
      document.getElementById('tri_out').textContent = out;
    }

    // ------------ PROJECTILE FLEXIBLE SOLVER --------------
    function proj_clear(){ ['pm_v0_f','pm_theta_f','pm_g_f','pm_T_f','pm_R_f','pm_H_f'].forEach(id=>document.getElementById(id).value=''); document.getElementById('pm_out').textContent=''; }
    function proj_flexible(){
      let v0 = toNum(document.getElementById('pm_v0_f').value);
      let theta = toNum(document.getElementById('pm_theta_f').value); // degrees
      let g = toNum(document.getElementById('pm_g_f').value) || 9.81;
      let T = toNum(document.getElementById('pm_T_f').value);
      let R = toNum(document.getElementById('pm_R_f').value);
      let H = toNum(document.getElementById('pm_H_f').value);
      const known = x => x!==null;
      let changed=true; let iter=0;
      const deg2rad = d => d * Math.PI/180; const rad2deg = r => r * 180/Math.PI;
      while(changed && iter<20){ changed=false; iter++;
        // If v0 and theta known -> compute T,R,H
        if(known(v0) && known(theta)){
          const th = deg2rad(theta);
          if(!known(T)) { T = 2*v0*Math.sin(th)/g; changed=true; }
          if(!known(R)) { R = (v0*v0*Math.sin(2*th))/g; changed=true; }
          if(!known(H)) { H = (v0*v0*Math.sin(th)*Math.sin(th))/(2*g); changed=true; }
        }
        // If T known and theta known -> compute v0
        if(known(T) && known(theta) && !known(v0)){
          const th = deg2rad(theta);
          v0 = (T * g) / (2*Math.sin(th)); changed=true;
        }
        // If R and theta known -> compute v0
        if(known(R) && known(theta) && !known(v0)){
          const th = deg2rad(theta);
          const denom = Math.sin(2*th);
          if(Math.abs(denom) > 1e-12){ v0 = Math.sqrt(R*g/denom); changed=true; }
        }
        // If v0 and R known -> compute theta (two solutions possible), choose principal
        if(known(v0) && known(R) && !known(theta)){
          const val = R*g/(v0*v0);
          if(Math.abs(val) <= 1){
            const twoTh = Math.asin(val); // principal in radians
            theta = rad2deg(twoTh/2); changed=true;
          }
        }
        // If H and v0 known -> compute theta (sin^2 th = 2gH / v0^2)
        if(known(H) && known(v0) && !known(theta)){
          const v = (2*g*H)/(v0*v0);
          if(v>=0 && v<=1){ theta = rad2deg(Math.asin(Math.sqrt(v))); changed=true; }
        }
        // If H and theta known -> compute v0
        if(known(H) && known(theta) && !known(v0)){
          const th = deg2rad(theta);
          const denom = Math.sin(th)*Math.sin(th);
          if(denom>0){ v0 = Math.sqrt(2*g*H/denom); changed=true; }
        }
        // If T and v0 known -> compute theta
        if(known(T) && known(v0) && !known(theta)){
          const val = (T*g)/(2*v0);
          if(Math.abs(val) <= 1){ theta = rad2deg(Math.asin(val)); changed=true; }
        }
      }
      const out = `Iterations: ${iter}
`+
        `v0 = ${fmt(v0)} m/s
θ = ${fmt(theta)}°
g = ${fmt(g)} m/s²
T = ${fmt(T)} s
R = ${fmt(R)} m
H = ${fmt(H)} m`;
      document.getElementById('pm_out').textContent = out;
    }

  </script>
</body>
</html>
